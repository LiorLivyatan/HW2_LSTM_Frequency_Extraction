# LSTM Frequency Extraction Configuration
# This configuration file controls all hyperparameters and paths for the pipeline
# See CONFIG.md for detailed parameter documentation

# Data Generation
data:
  frequencies: [1, 3, 5, 7]  # Hz - the 4 frequencies to extract
  sampling_rate: 1000         # Hz - 1000 samples per second
  duration: 10.0              # seconds - 10 seconds of signal
  train_seed: 1               # Random seed for training set
  test_seed: 2                # Random seed for test set (different noise)
  data_dir: "data"

# Model Architecture
# IMPORTANT: L=1 CONSTRAINT EXPLANATION
# - L=1 means sequence_length=1 (each sample is one time point, processed individually)
# - L=1 does NOT constrain num_layers (number of stacked LSTM layers)
# - PyTorch LSTM would normally reset hidden state between samples when L=1
# - We manually preserve state in the training loop to create an effective temporal window
# - This manual state management is the core pedagogical challenge of the assignment
model:
  input_size: 5               # S(t) + 4-dim one-hot selector
  hidden_size: 128            # LSTM hidden dimension (doubled from 64 for capacity)
  num_layers: 1               # Number of stacked LSTM layers (can experiment with 1, 2, 3, etc.)
  dropout: 0.0                # Dropout between LSTM layers (only used if num_layers > 1)

# Training
training:
  learning_rate: 0.0001       # Adam learning rate (reduced from 0.001)
  num_epochs: 100             # Training epochs
  batch_size: 32              # Batch size (32 parallel sequences, each with sequence_length=1)
  clip_grad_norm: 1.0         # Gradient clipping for stability
  device: "auto"              # auto, cpu, or cuda
  save_dir: "models"

# Evaluation
evaluation:
  generalization_threshold: 0.1  # 10% - maximum acceptable difference between train/test MSE

# Visualization
visualization:
  comparison_freq_idx: 1      # fâ‚‚ = 3Hz (0-indexed)
  time_window: 1000           # First 1 second (1000 samples)
  dpi: 300                    # Publication quality
  output_dir: "outputs/graphs"

# Paths
paths:
  train_data: "data/train_data.npy"
  test_data: "data/test_data.npy"
  model_checkpoint: "models/best_model.pth"
  metrics: "outputs/metrics.json"
  predictions: "outputs/predictions.npz"
  training_history: "models/training_history.json"
  log_file: "logs/lstm_extraction.log"
